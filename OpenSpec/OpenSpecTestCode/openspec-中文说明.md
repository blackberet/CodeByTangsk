# OpenSpec 中文详细说明

## 概述
OpenSpec 是一种以规格为中心的轻量工作流，用来在编码前锁定需求意图，让人类与 AI 助手在实现之前达成一致。它不依赖任何 API Key，强调在变更、任务与规格之间建立明确、可审计的关联，从而输出可复现、可评审的结果。

- 目标：将“要做什么”与“如何实现”分离；在编码前形成可对齐、可回溯的规格与变更计划
- 产出：结构化的变更文件夹（提案、任务、规格差异），以及作为真源的规格目录
- 适用场景：不仅适合 0→1 的新功能，也擅长 1→n 的既有行为修改（Brownfield-first）

## 关键价值
- 对齐与确定性：在实现前锁定规格与任务，减少聊天碎片化导致的跑偏
- 可审计的范围：提案、任务、规格更新分开放置，变更和范围清晰
- 共享可见性：已提议、进行中与已归档的状态清楚，团队协作更顺畅
- 与现有 AI 工具兼容：在支持的平台上通过内置命令或上下文规则工作

## 工作流（How It Works）
1. 草拟变更提案（Draft Change Proposal）：提出要更新的规格点与动机，形成可评审的变更意图  
2. 评审与对齐（Review & Align）：在提案层面迭代，确定任务清单与规格更新内容  
3. 实施任务（Implement Tasks）：AI 或开发者依据已对齐的提案与规格来编写代码、验证与交付  
4. 归档与更新（Archive & Update）：将已批准的变更合并到真源规格，形成一次闭环

上述 1↔2 保留反馈循环，直到提案与任务达成一致为止，随后才进入实施与归档。

## 目录结构与约定
OpenSpec 推荐将“真源规格”与“变更提案”分离管理：

- openspec/specs/：真源规格目录，当前的真实行为与接口定义
- openspec/changes/：变更提案与任务目录，包含提案、任务以及对 specs 的差异更新
- 归档动作负责将经过批准的更新合并回 specs，从而保持真源一致性

示例目录模板：

```
openspec/
  specs/
    auth.md
    payments.md
  changes/
    2026-01-14-add-2fa/
      proposal.md
      tasks/
        implement-2fa.md
        update-login-ui.md
      spec-deltas/
        auth.md
```

## Brownfield-first 与工具对比
- 与面向 0→1 的工具相比（如 spec-kit、Kiro 等），OpenSpec 在 1→n 的行为修改上更强，强调将“真源规格”与“提议变更”分离，从而让跨规格、跨模块的更新更可控
- 对于已有系统的持续迭代，OpenSpec 能更清晰地表达“变更范围”与“对既有规格的影响”，降低回归与偏差风险

## 命令与平台支持
在支持的平台上，通常使用以下命令约定来驱动工作：

- 打开或创建提案：/openspec-proposal  
- 应用提案到工作区：/openspec-apply  
- 归档并更新真源规格：/openspec-archive  

这些命令在不同工具中以各自的目录或工作流形式存在，例如 .github/prompts、.continue/prompts、.amazonq/prompts 等。核心思想是一致的：先提案与对齐，再实施任务，最后归档同步到 specs。

## OPSX（实验性工作流）
OPSX 是一种“schema 驱动、可 hack、可流动”的实验工作流，支持在不修改代码的情况下迭代工作流本身。它将工作流的结构抽象为可配置的 schema，从而让团队快速试验并适配自己的流程。

## 使用指南（建议实践）
- 建提案：在 changes/ 下创建变更目录，写明动机、范围、影响面以及要更新的规格点
- 对齐任务：根据提案分解任务，尽量让每个任务对应清晰的实现与验证方式
- 关联规格：明确哪些 specs 将被更新，如何更新；在 spec-deltas 里写出差异
- 实施与验证：引用已对齐的任务与规格更新进行编码、测试与审查
- 归档动作：完成后归档，把差异合并回 specs，保持真源与实现同步

## 示例流程（文字版）
场景：在既有的登录系统中上线双重验证（2FA）

1. 在 changes/ 下创建 2026-01-14-add-2fa，撰写 proposal.md（阐述动机、用户路径、失败与恢复）  
2. 在 tasks/ 下列出 implement-2fa.md、update-login-ui.md 等任务  
3. 在 spec-deltas/ 下编写 auth.md 差异，说明新增接口、状态机变化与错误码  
4. 经过评审与对齐后实施任务，联调与测试  
5. 成功交付后归档，将 spec-deltas 合并到 openspec/specs/auth.md

## 选型建议
- 若你正在维护一套已有系统并频繁做增量更新，OpenSpec 能让“范围与影响”更透明，适配跨团队协作
- 若你从零构建新系统，OpenSpec 也可使用，但在 0→1 的设计组织上可以与其它工具配合

## 常见问题
- 是否需要 API Key：不需要  
- 提案与任务是否必须同一目录：建议统一置于 changes/ 的单次变更目录下便于审计  
- 如何避免跑偏：在 Review & Align 阶段充分对齐，必要时迭代提案与任务，避免直接编码

## 本地目录说明
你的本地路径 `/Users/tangshengkui/CodeByTangsk/OpenSpec/OpenSpecTestCode` 当前未检测到已有内容。本说明文档已创建于该路径，后续可按上述模板在该目录下补充提案与规格示例。

---

附：OpenSpec 官方仓库地址  
https://github.com/Fission-AI/OpenSpec

